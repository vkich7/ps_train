{
	"info": {
		"_postman_id": "2b7e39e5-de7c-47e3-98a5-98060c4e53b3",
		"name": "Task_01",
		"schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json",
		"_exporter_id": "28293803",
		"_collection_link": "https://restless-sunset-306564.postman.co/workspace/TestPetStoreWs~2811569e-a537-4fa0-b19c-f791f24cf85b/collection/28293803-2b7e39e5-de7c-47e3-98a5-98060c4e53b3?action=share&creator=28293803&source=collection_link"
	},
	"item": [
		{
			"name": "json schema validatioin",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"const schema=\r",
							"{\r",
							"  \"$schema\": \"http://json-schema.org/draft-07/schema#\",\r",
							"  \"type\": \"object\",\r",
							"  \"properties\": {\r",
							"    \"resultsPerPage\": {\r",
							"      \"type\": \"integer\"\r",
							"    },\r",
							"    \"startIndex\": {\r",
							"      \"type\": \"integer\"\r",
							"    },\r",
							"    \"totalResults\": {\r",
							"      \"type\": \"integer\"\r",
							"    },\r",
							"    \"format\": {\r",
							"      \"type\": \"string\"\r",
							"    },\r",
							"    \"version\": {\r",
							"      \"type\": \"string\"\r",
							"    },\r",
							"    \"timestamp\": {\r",
							"      \"type\": \"string\"\r",
							"    },\r",
							"    \"vulnerabilities\": {\r",
							"      \"type\": \"array\",\r",
							"      \"items\": {\r",
							"        \"type\": \"object\",\r",
							"        \"properties\": {\r",
							"          \"cve\": {\r",
							"            \"type\": \"object\",\r",
							"            \"properties\": {\r",
							"              \"id\": {\r",
							"                \"type\": \"string\"\r",
							"              },\r",
							"              \"sourceIdentifier\": {\r",
							"                \"type\": \"string\"\r",
							"              },\r",
							"              \"published\": {\r",
							"                \"type\": \"string\"\r",
							"              },\r",
							"              \"lastModified\": {\r",
							"                \"type\": \"string\"\r",
							"              },\r",
							"              \"vulnStatus\": {\r",
							"                \"type\": \"string\"\r",
							"              },\r",
							"              \"descriptions\": {\r",
							"                \"type\": \"array\",\r",
							"                \"items\": {\r",
							"                  \"type\": \"object\",\r",
							"                  \"properties\": {\r",
							"                    \"lang\": {\r",
							"                      \"type\": \"string\"\r",
							"                    },\r",
							"                    \"value\": {\r",
							"                      \"type\": \"string\"\r",
							"                    }\r",
							"                  }\r",
							"                }\r",
							"              },\r",
							"              \"metrics\": {\r",
							"                \"type\": \"object\",\r",
							"                \"properties\": {\r",
							"                  \"cvssMetricV31\": {\r",
							"                    \"type\": \"array\",\r",
							"                    \"items\": {\r",
							"                      \"type\": \"object\",\r",
							"                      \"properties\": {\r",
							"                        \"source\": {\r",
							"                          \"type\": \"string\"\r",
							"                        },\r",
							"                        \"type\": {\r",
							"                          \"type\": \"string\"\r",
							"                        },\r",
							"                        \"cvssData\": {\r",
							"                          \"type\": \"object\",\r",
							"                          \"properties\": {\r",
							"                            \"version\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"vectorString\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"attackVector\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"attackComplexity\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"privilegesRequired\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"userInteraction\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"scope\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"confidentialityImpact\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"integrityImpact\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"availabilityImpact\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"baseScore\": {\r",
							"                              \"type\": \"number\"\r",
							"                            },\r",
							"                            \"baseSeverity\": {\r",
							"                              \"type\": \"string\"\r",
							"                            }\r",
							"                          }\r",
							"                        },\r",
							"                        \"exploitabilityScore\": {\r",
							"                          \"type\": \"number\"\r",
							"                        },\r",
							"                        \"impactScore\": {\r",
							"                          \"type\": \"number\"\r",
							"                        }\r",
							"                      }\r",
							"                    }\r",
							"                  },\r",
							"                  \"cvssMetricV2\": {\r",
							"                    \"type\": \"array\",\r",
							"                    \"items\": {\r",
							"                      \"type\": \"object\",\r",
							"                      \"properties\": {\r",
							"                        \"source\": {\r",
							"                          \"type\": \"string\"\r",
							"                        },\r",
							"                        \"type\": {\r",
							"                          \"type\": \"string\"\r",
							"                        },\r",
							"                        \"cvssData\": {\r",
							"                          \"type\": \"object\",\r",
							"                          \"properties\": {\r",
							"                            \"version\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"vectorString\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"accessVector\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"accessComplexity\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"authentication\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"confidentialityImpact\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"integrityImpact\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"availabilityImpact\": {\r",
							"                              \"type\": \"string\"\r",
							"                            },\r",
							"                            \"baseScore\": {\r",
							"                              \"type\": \"number\"\r",
							"                            }\r",
							"                          }\r",
							"                        },\r",
							"                        \"baseSeverity\": {\r",
							"                          \"type\": \"string\"\r",
							"                        },\r",
							"                        \"exploitabilityScore\": {\r",
							"                          \"type\": \"number\"\r",
							"                        },\r",
							"                        \"impactScore\": {\r",
							"                          \"type\": \"number\"\r",
							"                        },\r",
							"                        \"acInsufInfo\": {\r",
							"                          \"type\": \"boolean\"\r",
							"                        },\r",
							"                        \"obtainAllPrivilege\": {\r",
							"                          \"type\": \"boolean\"\r",
							"                        },\r",
							"                        \"obtainUserPrivilege\": {\r",
							"                          \"type\": \"boolean\"\r",
							"                        },\r",
							"                        \"obtainOtherPrivilege\": {\r",
							"                          \"type\": \"boolean\"\r",
							"                        },\r",
							"                        \"userInteractionRequired\": {\r",
							"                          \"type\": \"boolean\"\r",
							"                        }\r",
							"                      }\r",
							"                    }\r",
							"                  }\r",
							"                }\r",
							"              },\r",
							"              \"weaknesses\": {\r",
							"                \"type\": \"array\",\r",
							"                \"items\": {\r",
							"                  \"type\": \"object\",\r",
							"                  \"properties\": {\r",
							"                    \"source\": {\r",
							"                      \"type\": \"string\"\r",
							"                    },\r",
							"                    \"type\": {\r",
							"                      \"type\": \"string\"\r",
							"                    },\r",
							"                    \"description\": {\r",
							"                      \"type\": \"array\",\r",
							"                      \"items\": {\r",
							"                        \"type\": \"object\",\r",
							"                        \"properties\": {\r",
							"                          \"lang\": {\r",
							"                            \"type\": \"string\"\r",
							"                          },\r",
							"                          \"value\": {\r",
							"                            \"type\": \"string\"\r",
							"                          }\r",
							"                        }\r",
							"                      }\r",
							"                    }\r",
							"                  }\r",
							"                }\r",
							"              },\r",
							"              \"configurations\": {\r",
							"                \"type\": \"array\",\r",
							"                \"items\": {\r",
							"                  \"type\": \"object\",\r",
							"                  \"properties\": {\r",
							"                    \"nodes\": {\r",
							"                      \"type\": \"array\",\r",
							"                      \"items\": {\r",
							"                        \"type\": \"object\",\r",
							"                        \"properties\": {\r",
							"                          \"operator\": {\r",
							"                            \"type\": \"string\"\r",
							"                          },\r",
							"                          \"negate\": {\r",
							"                            \"type\": \"boolean\"\r",
							"                          },\r",
							"                          \"cpeMatch\": {\r",
							"                            \"type\": \"array\",\r",
							"                            \"items\": {\r",
							"                              \"type\": \"object\",\r",
							"                              \"properties\": {\r",
							"                                \"vulnerable\": {\r",
							"                                  \"type\": \"boolean\"\r",
							"                                },\r",
							"                                \"criteria\": {\r",
							"                                  \"type\": \"string\"\r",
							"                                },\r",
							"                                \"matchCriteriaId\": {\r",
							"                                  \"type\": \"string\"\r",
							"                                }\r",
							"                              }\r",
							"                            }\r",
							"                          }\r",
							"                        }\r",
							"                      }\r",
							"                    }\r",
							"                  }\r",
							"                }\r",
							"              },\r",
							"              \"references\": {\r",
							"                \"type\": \"array\",\r",
							"                \"items\": {\r",
							"                  \"type\": \"object\",\r",
							"                  \"properties\": {\r",
							"                    \"url\": {\r",
							"                      \"type\": \"string\"\r",
							"                    },\r",
							"                    \"source\": {\r",
							"                      \"type\": \"string\"\r",
							"                    },\r",
							"                    \"tags\": {\r",
							"                      \"type\": \"array\",\r",
							"                      \"items\": {\r",
							"                        \"type\": \"string\"\r",
							"                      }\r",
							"                    }\r",
							"                  }\r",
							"                }\r",
							"              }\r",
							"            }\r",
							"          }\r",
							"        }\r",
							"      }\r",
							"    }\r",
							"  }\r",
							"};\r",
							"\r",
							"pm.test(\"Response matches the JSON schema\", () =>\r",
							"    pm.response.to.have.jsonSchema(schema));\r",
							"\r",
							"pm.test(\"Values of ID and vesion are not empty\", () =>\r",
							"{\r",
							"    var responseBody = pm.response.json();\r",
							"    var vulnerabilitiesArray = responseBody.vulnerabilities;\r",
							"    var oves={};\r",
							"    var versions={};\r",
							"    for (var i = 0; i < vulnerabilitiesArray.length; i++) \r",
							"    {\r",
							"        var vulnerability = vulnerabilitiesArray[i];\r",
							"        oves[\"id\"] = vulnerability.cve.id;\r",
							"        console.log(\"CVE ID:\", vulnerability.cve.id);\r",
							"        cvssMetricV31Array = vulnerability.cve.metrics.cvssMetricV31;\r",
							"        for (var j = 0; j < cvssMetricV31Array.length; j++) \r",
							"        {\r",
							"            var cvssMetricV31 = cvssMetricV31Array[j];\r",
							"            versions[\"version\"] = cvssMetricV31.cvssData.version;\r",
							"            console.log(\"version:\", versions[\"version\"]);\r",
							"        }\r",
							"        pm.expect(oves[\"id\"], !null);\r",
							"        pm.expect(versions[\"version\"], !null);\r",
							"        pm.expect(versions[\"version\"].length).to.not.eql(0);\r",
							"    }\r",
							"}\r",
							")\r",
							"pm.test(\"Status code is 200\", () => {\r",
							"  pm.response.to.have.status(200);\r",
							"});\r",
							"pm.test(\"Probe fail test\", () => {\r",
							"        pm.expect(0).to.not.eql(0);\r",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "GET",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "",
					"options": {
						"raw": {
							"language": "text"
						}
					}
				},
				"url": {
					"raw": "{{url}}?resultsPerPage={{quantityPerPage}}&pubStartDate={{startDate}}&pubEndDate={{endDate}}",
					"host": [
						"{{url}}"
					],
					"query": [
						{
							"key": "resultsPerPage",
							"value": "{{quantityPerPage}}"
						},
						{
							"key": "pubStartDate",
							"value": "{{startDate}}"
						},
						{
							"key": "pubEndDate",
							"value": "{{endDate}}"
						}
					]
				}
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "url",
			"value": "",
			"type": "string"
		},
		{
			"key": "startDate",
			"value": "",
			"type": "string"
		},
		{
			"key": "endDate",
			"value": "",
			"type": "string"
		},
		{
			"key": "quantityPerPage",
			"value": "",
			"type": "string"
		}
	]
}